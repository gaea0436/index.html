<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>è¯çš„æ±äº¬ç¨æ—… 2026</title>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@400;500;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            /* --- æº«æš–ç¾©å¤§åˆ©è‰²ç³»å„ªåŒ–ç‰ˆ --- */
            --primary: #6B8E9B;       /* è«è˜­è¿ªæ¹–æ°´ç¶  (ä¸»è‰²) */
            --primary-light: #E0E9EB; /* æ¥µæ·ºæ¹–æ°´ç¶  (æ—¥æœŸèƒŒæ™¯) */
            --bg: #F9F7F5;            /* æº«æš–ç±³ç™½åº•è‰² (æ¯”ç°è‰²æ›´æº«é¦¨) */
            --text: #5A5A5A;          /* æš–æ·±ç° */
            --text-light: #949494;    /* æ·ºç° */
            --card-bg: #FFFFFF;
            --accent: #C5A087;        /* å¥¶èŒ¶æš–æ£• (å¼·èª¿è‰²/æŒ‰éˆ•) */
            --line: #E8E8E8;          /* ç·šæ¢è‰² */
            
            /* æ¨™ç±¤é…è‰² */
            --tag-transport: #DDE5E8; 
            --tag-spot: #EAE4DC;      
            --tag-food: #EFEBE5;      
        }

        * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; }
        body {
            font-family: 'Noto Sans TC', sans-serif;
            background-color: var(--bg);
            color: var(--text);
            margin: 0;
            padding: 0;
            padding-bottom: 90px;
        }

        /* --- Header: æµªæ¼«æ¨™é¡Œèˆ‡æ°£è±¡ --- */
        .header {
            background: linear-gradient(135deg, var(--primary), #557582);
            color: white;
            padding: 20px 20px 30px 20px;
            border-radius: 0 0 30px 30px;
            box-shadow: 0 10px 20px rgba(107, 142, 155, 0.25);
            position: relative;
            z-index: 100;
        }
        
        .main-title {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 20px;
        }
        .main-title h2 {
            margin: 0;
            font-size: 1.4rem;
            font-weight: 700;
            letter-spacing: 1px;
            text-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        /* æ—¥æœ¬åœ‹æ——é£„å‹•å‹•ç•« */
        @keyframes wave {
            0% { transform: rotate(0deg); }
            25% { transform: rotate(5deg); }
            75% { transform: rotate(-5deg); }
            100% { transform: rotate(0deg); }
        }
        .flag-icon {
            font-size: 1.5rem;
            animation: wave 3s infinite ease-in-out;
            display: inline-block;
            filter: drop-shadow(0 2px 3px rgba(0,0,0,0.2));
        }

        .weather-widget {
            display: flex;
            justify-content: space-between;
            align-items: flex-end;
        }
        .temp-box p { margin: 0; font-size: 0.9rem; opacity: 0.9; font-weight: 400; margin-bottom: 2px;}
        /* ç¸®å°æ°£æº«å­—é«” */
        .temp-box h1 { margin: 0; font-size: 2rem; font-weight: 500; letter-spacing: 1px; line-height: 1.1; }
        
        .outfit-tip {
            background: rgba(255,255,255,0.2);
            padding: 8px 12px;
            border-radius: 12px;
            font-size: 0.8rem;
            max-width: 60%;
            display: flex;
            align-items: center;
            gap: 8px;
            backdrop-filter: blur(5px);
            line-height: 1.4;
            border: 1px solid rgba(255,255,255,0.3);
        }

        /* --- æ—¥æœŸé¸æ“‡å™¨ (D1~D6) --- */
        .date-scroller {
            display: flex;
            overflow-x: auto;
            padding: 20px 15px;
            gap: 10px;
            scrollbar-width: none;
        }
        .date-scroller::-webkit-scrollbar { display: none; }
        
        .date-chip {
            background: white;
            min-width: 75px;
            height: 75px;
            padding: 10px;
            border-radius: 18px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            color: var(--text-light);
            border: 1px solid white;
            transition: all 0.3s ease;
            cursor: pointer;
            box-shadow: 0 4px 10px rgba(0,0,0,0.03);
            flex-shrink: 0; /* é˜²æ­¢è¢«æ“ å£“ */
        }
        .date-chip strong {
            font-size: 1.4rem;
            font-weight: 700;
            margin-bottom: 2px;
            color: #C0C0C0;
        }
        .date-chip span {
            font-size: 0.75rem;
        }
        
        /* é¸ä¸­ç‹€æ…‹ */
        .date-chip.active {
            background: var(--card-bg); /* ä¿æŒç™½è‰²èƒŒæ™¯ */
            border: 2px solid var(--primary); /* åŠ ä¸Šæ¡†ç·š */
            transform: translateY(-2px);
            box-shadow: 0 8px 15px rgba(107, 142, 155, 0.2);
        }
        .date-chip.active strong { color: var(--primary); }
        .date-chip.active span { color: var(--primary); font-weight: bold; }

        /* --- è¡Œç¨‹æ™‚é–“è»¸ --- */
        .timeline-container { padding: 10px 20px; }
        .timeline-item {
            display: flex;
            margin-bottom: 30px;
            position: relative;
        }
        /* å‚ç›´ç·š */
        .timeline-item::before {
            content: '';
            position: absolute;
            left: 60px; /* ç·šçš„ä½ç½® */
            top: 15px;
            bottom: -35px;
            width: 2px;
            background: var(--line);
            z-index: 0;
        }
        .timeline-item:last-child::before { display: none; }

        /* æ™‚é–“æ³¡æ³¡ (å·¦å´) */
        .time-col {
            width: 60px;
            padding-right: 20px;
            text-align: right;
            font-size: 0.85rem;
            font-weight: 700;
            color: var(--primary);
            padding-top: 12px;
            z-index: 1;
            position: relative;
        }
        /* ç™½è‰²åœ“é»è£é£¾ */
        .timeline-item::after {
            content: '';
            position: absolute;
            left: 56px; /* ç·šçš„ä½ç½® - åŠå¾‘ */
            top: 18px;
            width: 10px;
            height: 10px;
            background: white;
            border: 2px solid var(--primary);
            border-radius: 50%;
            z-index: 2;
        }

        /* å…§å®¹å¡ç‰‡ */
        .content-col {
            flex: 1;
            background: var(--card-bg);
            border-radius: 20px; /* æ›´åœ“æ½¤ */
            padding: 0; /* åœ–ç‰‡æ»¿ç‰ˆï¼Œpaddingæ”¹åœ¨å…§éƒ¨ */
            box-shadow: 0 8px 20px rgba(0,0,0,0.04);
            position: relative; /* ç‚ºäº†å°èˆªæŒ‰éˆ•å®šä½ */
            z-index: 1;
            overflow: hidden; /* åœ–ç‰‡åœ“è§’ */
            border: 1px solid rgba(0,0,0,0.01);
        }

        /* è¡Œç¨‹åœ–ç‰‡ */
        .card-img {
            width: 100%;
            height: 140px;
            object-fit: cover;
            display: block;
            background-color: #eee;
        }
        .card-body { padding: 15px 18px 18px 18px; }

        .content-col h3 { margin: 0 0 6px 0; font-size: 1.1rem; color: #4F5D64; font-weight: 700;}
        
        .tag {
            display: inline-block;
            font-size: 0.7rem;
            padding: 2px 8px;
            border-radius: 6px;
            color: #666;
            margin-bottom: 8px;
            font-weight: 500;
        }
        .tag.äº¤é€š { background: var(--tag-transport); color: #546E7A; }
        .tag.æ™¯é», .tag.è§€å…‰ { background: var(--tag-spot); color: #8D7663; }
        .tag.é¤é£², .tag.è³¼ç‰© { background: var(--tag-food); color: #8A7E72; }
        .tag.ä½å®¿ { background: var(--secondary); color: #607D8B; }

        .note {
            font-size: 0.9rem;
            color: #777;
            margin-top: 8px;
            line-height: 1.6;
        }

        /* å°èˆªæŒ‰éˆ• (å³ä¸Šè§’) */
        .nav-btn-corner {
            position: absolute;
            top: 15px;
            right: 15px;
            background: rgba(255, 255, 255, 0.9);
            color: var(--primary);
            padding: 6px 12px;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: 600;
            text-decoration: none;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            backdrop-filter: blur(2px);
            display: flex;
            align-items: center;
            gap: 5px;
            z-index: 10;
        }

        /* --- åº•éƒ¨å°èˆª --- */
        .bottom-nav {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            background: white;
            display: flex;
            justify-content: space-around;
            padding: 12px 0;
            box-shadow: 0 -4px 20px rgba(0,0,0,0.05);
            z-index: 200;
            border-top-left-radius: 20px;
            border-top-right-radius: 20px;
        }
        .nav-item {
            text-align: center;
            color: #C0C0C0;
            font-size: 0.75rem;
            cursor: pointer;
            transition: color 0.3s;
        }
        .nav-item.active { color: var(--primary); }
        .nav-item i { font-size: 1.3rem; display: block; margin-bottom: 5px; }

        /* --- å…¶ä»–é é¢ --- */
        .page { display: none; padding-bottom: 20px; animation: fadeIn 0.3s ease; }
        .page.active { display: block; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }

        /* ç¾é£Ÿå¡ç‰‡ */
        .food-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            padding: 15px;
        }
        .food-card {
            background: white;
            border-radius: 15px;
            overflow: hidden;
            box-shadow: 0 4px 10px rgba(0,0,0,0.03);
        }
        .food-img-placeholder {
            height: 120px;
            background: var(--tag-food);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 2.5rem;
        }
        /* å¦‚æœæœ‰çœŸå¯¦åœ–ç‰‡ */
        .real-food-img {
            width: 100%;
            height: 120px;
            object-fit: cover;
        }

        .food-info { padding: 12px; }
        .food-name { font-weight: bold; font-size: 0.95rem; margin-bottom: 5px; color: #555; }
        .food-jp { color: #999; font-size: 0.8rem; margin-bottom: 8px; }
        .food-price { color: var(--accent); font-weight: bold; }

        /* å·¥å…·ç®± */
        .tools-container { padding: 20px; }
        .tool-card {
            background: white;
            padding: 20px;
            border-radius: 16px;
            margin-bottom: 20px;
            box-shadow: 0 4px 10px rgba(0,0,0,0.03);
        }
        .tool-card h3 { color: var(--primary); margin-top: 0; }
        .tool-btn {
            background: var(--accent);
            color: white;
            border: none;
            padding: 12px;
            width: 100%;
            border-radius: 10px;
            font-size: 1rem;
            margin-top: 10px;
            cursor: pointer;
        }
        .input-group { display: flex; gap: 10px; margin-bottom: 10px; }
        .input-group input { 
            flex: 1; padding: 12px; border: 1px solid #eee; border-radius: 8px; 
            font-size: 1rem; background: #FAFAFA;
        }

        /* ç¿»è­¯å€ */
        .translate-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
        }
        .phrase-btn {
            background: white;
            border: 1px solid var(--accent);
            color: var(--accent);
            padding: 15px 10px;
            border-radius: 12px;
            text-align: center;
            font-size: 0.9rem;
            cursor: pointer;
            transition: all 0.2s;
            position: relative;
            overflow: hidden;
        }
        .phrase-btn:active { background: var(--accent); color: white; transform: scale(0.98); }
        .phrase-btn i { display: block; margin-bottom: 5px; opacity: 0.5; }

    </style>
</head>
<body>

    <div class="header" id="headerWidget">
        <div class="main-title">
            <span class="flag-icon">ğŸ‡¯ğŸ‡µ</span>
            <h2>æ±äº¬ï¼å†¬æ—¥æˆ€æ­Œ</h2>
        </div>
        <div class="weather-widget">
            <div class="temp-box">
                <p id="currentDateDisplay">2æœˆ3æ—¥ (äºŒ)</p>
                <h1 id="weatherTemp">6Â°C</h1>
            </div>
            <div class="outfit-tip" id="weatherTip">
                <i class="fas fa-tshirt"></i> <span>å¯’å†·ï¼Œè«‹ç©¿è‘—ç¾½çµ¨è¡£ä¸¦æ”œå¸¶åœå·¾</span>
            </div>
        </div>
    </div>

    <div class="date-scroller" id="dateNav"></div>

    <div id="page-itinerary" class="page active">
        <div class="timeline-container" id="itineraryList"></div>
    </div>

    <div id="page-food" class="page">
        <div style="padding: 20px;">
            <h2 style="color:var(--text); font-weight:500;"><i class="fas fa-utensils" style="color:var(--primary)"></i> è¶…å•†å¿…åƒ</h2>
            <p style="color:#888; font-size:0.9rem;">å·²ç‚ºæ‚¨æ•´ç†å¥½æ¸…å–®ï¼Œçµå¸³æ™‚å¯ç›´æ¥å‡ºç¤ºåœ–ç‰‡çµ¦åº—å“¡çœ‹ã€‚</p>
        </div>
        <div class="food-grid" id="foodList"></div>
    </div>

    <div id="page-tools" class="page">
        <div class="tools-container">
            
            <div class="tool-card">
                <h3><i class="fas fa-volume-up"></i> é»æ“Šèªªæ—¥æ–‡</h3>
                <p style="font-size:0.8rem; color:#999; margin-bottom:15px;">é»æ“Šä¸‹æ–¹æŒ‰éˆ•ï¼Œæ‰‹æ©Ÿæœƒç›´æ¥å”¸å‡ºæ—¥æ–‡ (è«‹é–‹è²éŸ³)</p>
                <div class="translate-grid">
                    <div class="phrase-btn" onclick="speak('ã™ã¿ã¾ã›ã‚“ã€ãƒˆã‚¤ãƒ¬ã¯ã©ã“ã§ã™ã‹ï¼Ÿ', 'Sumimasen, toire wa doko desu ka?')">
                        <i class="fas fa-restroom"></i> å»æ‰€åœ¨å“ªè£¡
                    </div>
                    <div class="phrase-btn" onclick="speak('ã“ã‚Œã‚’ãã ã•ã„ã€‚', 'Kore o kudasai')">
                        <i class="fas fa-hand-pointer"></i> è«‹çµ¦æˆ‘é€™å€‹
                    </div>
                    <div class="phrase-btn" onclick="speak('ãŠä¼šè¨ˆã‚’ãŠé¡˜ã„ã—ã¾ã™ã€‚', 'Okaikei o onegaishimasu')">
                        <i class="fas fa-wallet"></i> éº»ç…©çµå¸³
                    </div>
                    <div class="phrase-btn" onclick="speak('è¢‹ã¯ã„ã‚Šã¾ã›ã‚“ã€‚', 'Fukuro wa irimasen')">
                        <i class="fas fa-shopping-bag"></i> ä¸ç”¨è¢‹å­
                    </div>
                </div>
                <button class="tool-btn" style="background:var(--primary); margin-top:15px;" onclick="window.open('https://translate.google.com/?sl=zh-TW&tl=ja&op=translate')">
                    é–‹å•Ÿ Google ç¿»è­¯
                </button>
            </div>

            <div class="tool-card">
                <h3><i class="fas fa-calculator"></i> å¿«é€Ÿè¨˜å¸³</h3>
                <div class="input-group">
                    <input type="text" id="expenseName" placeholder="é …ç›® (å¦‚: æ‹‰éºµ)">
                    <input type="number" id="expenseAmount" placeholder="æ—¥å¹£é‡‘é¡">
                </div>
                <button class="tool-btn" onclick="addExpense()">åŠ å…¥è¨˜å¸³</button>
                <div style="margin-top: 20px; border-top: 1px solid #eee; padding-top:10px;">
                    <h4>ä»Šæ—¥ç¸½è¨ˆ: <span id="totalExpense" style="color:var(--accent)">Â¥0</span></h4>
                    <ul id="expenseList" style="padding-left: 20px; color:#666; font-size:0.9rem;"></ul>
                </div>
            </div>

            <div class="tool-card">
                <h3><i class="fas fa-suitcase"></i> é‡é»æª¢æŸ¥</h3>
                <label style="display:block; margin:8px 0; color:#555;"><input type="checkbox"> è­·ç…§ (éš¨èº«)</label>
                <label style="display:block; margin:8px 0; color:#555;"><input type="checkbox"> è¥¿ç“œå¡ (Suica)</label>
                <label style="display:block; margin:8px 0; color:#555;"><input type="checkbox"> ç¶²å¡ (SIM/eSIM)</label>
                <label style="display:block; margin:8px 0; color:#555;"><input type="checkbox"> ç¾é‡‘ (åƒåœ“éˆ”)</label>
            </div>
        </div>
    </div>

    <div class="bottom-nav">
        <div class="nav-item active" onclick="switchPage('itinerary', this)">
            <i class="fas fa-route"></i> è¡Œç¨‹
        </div>
        <div class="nav-item" onclick="switchPage('food', this)">
            <i class="fas fa-cookie-bite"></i> ç¾é£Ÿ
        </div>
        <div class="nav-item" onclick="switchPage('tools', this)">
            <i class="fas fa-tools"></i> å·¥å…·
        </div>
    </div>

    <script>
        // --- è³‡æ–™å€ ---
        
        // æ°£è±¡è³‡æ–™
        const weatherDB = {
            "2026-02-03": { temp: "5-11Â°", icon: "cloud-sun", tip: "æ­æ©Ÿæ—¥ï¼Œå»ºè­°æ´‹è”¥å¼ç©¿æ­ã€‚" },
            "2026-02-04": { temp: "3-9Â°", icon: "sun", tip: "æˆ¶å¤–å¤šï¼Œç©¿ç¾½çµ¨è¡£èˆ‡å¥½èµ°çš„é‹ã€‚" },
            "2026-02-05": { temp: "2-8Â°", icon: "snowflake", tip: "æ°£æº«è½‰å†·ï¼Œå»ºè­°æˆ´æ¯›å¸½ä¿æš–ã€‚" },
            "2026-02-06": { temp: "4-10Â°", icon: "cloud", tip: "å¸‚å€é€›è¡—ï¼Œç©¿è‘—èˆ’é©ä¿æš–å³å¯ã€‚" },
            "2026-02-07": { temp: "5-12Â°", icon: "sun", tip: "å¤©æ°£å›æš–ï¼Œé©åˆæ‹ç…§ã€‚" },
            "2026-02-08": { temp: "6-13Â°", icon: "plane", tip: "è¿”ç¨‹æ—¥ï¼Œè¡Œæä¿æŒè¼•ä¾¿ã€‚" }
        };

        /* ç¨‹å¼è¨­è¨ˆå¸«å°æ’‡æ­¥ï¼š
           img: æ¬„ä½æˆ‘å…ˆæ”¾äº†é è¨­åœ–ç¶²å€ã€‚
           å¦‚æœå¦³æƒ³æ›æˆè‡ªå·±çš„ç…§ç‰‡ï¼Œå°‡ä¾†å¯ä»¥ä¸Šå‚³åˆ°ç¶²è·¯ç›¸ç°¿å¾Œï¼ŒæŠŠç¶²å€è²¼éä¾†ã€‚
        */
        const itineraryDB = {
            "D1 2026-02-03(äºŒ)": [
                { time: "15:35", title: "æ¡ƒåœ’ T1 èµ·é£› (IT202)", type: "äº¤é€š", note: "å»ºè­°åœ¨æ©Ÿå ´å…ˆåƒåˆé¤ã€‚13:30 æŠµé”æ©Ÿå ´å ±åˆ°ã€‚", link: "geo:25.0797,121.2342", img: "https://images.unsplash.com/photo-1570710891163-6d3b5c47248b?auto=format&fit=crop&w=600&q=80" },
                { time: "19:35", title: "æŠµé”æˆç”° T2", type: "äº¤é€š", note: "è³¼è²·/å„²å€¼è¥¿ç“œå¡ (Suica)ã€‚", link: "geo:35.7719,140.3929", img: "https://images.unsplash.com/photo-1542640244-7e67286feb8f?auto=format&fit=crop&w=600&q=80" },
                { time: "20:30", title: "Skyliner å¾€å¸‚å€", type: "äº¤é€š", note: "è»Šä¸Šå¯å…ˆåƒé»è¼•é£Ÿã€‚è»Šç¨‹ç´„ 45 åˆ†é˜ã€‚", link: "", img: "https://images.unsplash.com/photo-1503899036084-c55cdd92da26?auto=format&fit=crop&w=600&q=80" },
                { time: "21:45", title: "å…¥ä½ï¼šå››è°·äº¬é˜ªé£¯åº—", type: "ä½å®¿", note: "å››è°·ç«™æ­¥è¡Œ3åˆ†é˜ã€‚æ¨“ä¸‹æœ‰è¶…å¸‚å¯è²·æ°´ã€‚", link: "https://www.google.com/maps/search/?api=1&query=Hotel+Keihan+Yotsuya", img: "https://images.unsplash.com/photo-1566073771259-6a8506099945?auto=format&fit=crop&w=600&q=80" }
            ],
            "D2 2026-02-04(ä¸‰)": [
                { time: "09:30", title: "ä¸Šé‡æ±ç…§å®®", type: "æ™¯é»", note: "é‡‘ç¢§è¼ç…Œçš„æ±Ÿæˆ¶å»ºç¯‰èˆ‡ç‰¡ä¸¹èŠ±åœ’ã€‚è¨˜å¾—è²·å¾¡å®ˆã€‚", link: "https://www.google.com/maps/search/?api=1&query=Ueno+Toshogu", img: "https://images.unsplash.com/photo-1596720426673-e4f28bc188f2?auto=format&fit=crop&w=600&q=80" },
                { time: "10:30", title: "ä¸Šé‡æ©è³œå…¬åœ’", type: "æ™¯é»", note: "ä¸å¿æ± è§€é³¥ã€è¾¯å¤©å ‚æ•£æ­¥æ‹ç…§ã€‚", link: "https://www.google.com/maps/search/?api=1&query=Ueno+Park", img: "https://images.unsplash.com/photo-1578469550956-0e16b69c6a3d?auto=format&fit=crop&w=600&q=80" },
                { time: "11:00", title: "ä¼Šè±†æ¦® æ¢…å·äº­", type: "é¤é£²", note: "ç™¾å¹´é°»é­šé£¯è€åº—ï¼Œç’°å¢ƒæ¸…å¹½ã€‚", link: "https://www.google.com/maps/search/?api=1&query=Izuei+Umekawatei", img: "https://images.unsplash.com/photo-1580442151529-343f2f6e0e27?auto=format&fit=crop&w=600&q=80" },
                { time: "11:30", title: "é˜¿ç¾æ©«ä¸", type: "è³¼ç‰©", note: "æ„Ÿå—ç†±é¬§å¸‚é›†æ°£æ°›ï¼Œè²·è—¥å¦ã€æ°´æœã€‚", link: "https://www.google.com/maps/search/?api=1&query=Ameyoko", img: "https://images.unsplash.com/photo-1554797584-c71b1116d230?auto=format&fit=crop&w=600&q=80" },
                { time: "13:00", title: "æ·ºè‰å¯º & é›·é–€", type: "æ™¯é»", note: "äººå¤šæ³¨æ„éš¨èº«ç‰©å“ã€‚ä»²è¦‹ä¸–é€šåƒäººå½¢ç‡’ã€‚", link: "https://www.google.com/maps/search/?api=1&query=Sensoji", img: "https://images.unsplash.com/photo-1563860533-36558ab479e7?auto=format&fit=crop&w=600&q=80" },
                { time: "14:00", title: "é¾œåéŠ…é‘¼ç‡’", type: "é¤é£²", note: "çŸ¥åæ’éšŠä¼´æ‰‹ç¦®ã€‚", link: "https://www.google.com/maps/search/?api=1&query=Kameju", img: "https://images.unsplash.com/photo-1579584425555-d35d0da400f4?auto=format&fit=crop&w=600&q=80" }
            ],
            "D3 2026-02-05(å››)": [
                { time: "09:00", title: "çš‡å±… (äºŒé‡æ©‹)", type: "æ™¯é»", note: "å¿…å¸¶è­·ç…§ã€‚æ¬£è³è­·åŸæ²³ã€çŸ³å£ã€‚", link: "https://www.google.com/maps/search/?api=1&query=Imperial+Palace+Tokyo", img: "https://images.unsplash.com/photo-1540959733332-eab4deabeeaf?auto=format&fit=crop&w=600&q=80" },
                { time: "11:30", title: "æ±äº¬è»Šç«™ä¸€ç•ªè¡—", type: "é¤é£²", note: "å…­å˜èˆæ²¾éºµæˆ–ç‰›èˆŒå®šé£Ÿã€‚", link: "https://www.google.com/maps/search/?api=1&query=Tokyo+Character+Street", img: "https://images.unsplash.com/photo-1519985176271-adb1088fa94c?auto=format&fit=crop&w=600&q=80" },
                { time: "14:00", title: "æ±äº¬å¤§ç¥å®®", type: "æ™¯é»", note: "æœ€å¼·çµç·£ç¥ç¤¾ï¼Œæ—¥å¼åº­åœ’æ¥µç¾ã€‚", link: "https://www.google.com/maps/search/?api=1&query=Tokyo+Daijingu", img: "https://images.unsplash.com/photo-1503917988258-f87a78e3c995?auto=format&fit=crop&w=600&q=80" },
                { time: "15:00", title: "ç§‹è‘‰åŸå°‹å¯¶", type: "è³¼ç‰©", note: "ç„¡ç·šé›»æœƒé¤¨ã€é§¿æ²³å±‹ï¼Œæ‰¾å¿—æ‘©å‡œå…¬ä»”ã€‚", link: "https://www.google.com/maps/search/?api=1&query=Radio+Kaikan", img: "https://images.unsplash.com/photo-1578556755452-19e3448f7b7f?auto=format&fit=crop&w=600&q=80" },
                { time: "17:30", title: "æ™šé¤ï¼šç¥ç”° è—ªè•éº¥", type: "é¤é£²", note: "ç™¾å¹´è€åº—ï¼Œé«”é©—æ±Ÿæˆ¶è€å‘³é“ã€‚", link: "https://www.google.com/maps/search/?api=1&query=Kanda+Yabu+Soba", img: "https://images.unsplash.com/photo-1519985176271-adb1088fa94c?auto=format&fit=crop&w=600&q=80" }
            ],
            "D4 2026-02-06(äº”)": [
                { time: "09:00", title: "æ˜æ²»ç¥å®®", type: "æ™¯é»", note: "éƒ½å¸‚æ£®æ—æ¼«æ­¥ï¼Œäº«å—æ¸…å¹½åƒé“ã€‚", link: "https://www.google.com/maps/search/?api=1&query=Meiji+Jingu", img: "https://images.unsplash.com/photo-1542051841857-5f90071e7989?auto=format&fit=crop&w=600&q=80" },
                { time: "12:00", title: "AFURI æŸšå­æ‹‰éºµ", type: "é¤é£²", note: "æ¸…çˆ½æŸšå­é¹½å£å‘³ï¼Œé©åˆå¥³ç”Ÿã€‚", link: "https://www.google.com/maps/search/?api=1&query=AFURI+Harajuku", img: "https://images.unsplash.com/photo-1569050467447-ce54b3bbc37d?auto=format&fit=crop&w=600&q=80" },
                { time: "13:30", title: "æ–°å®¿å¾¡è‹‘", type: "æ™¯é»", note: "ã€Šè¨€è‘‰ä¹‹åº­ã€‹å–æ™¯åœ°ï¼Œåº­åœ’æ¥µç¾ã€‚", link: "https://www.google.com/maps/search/?api=1&query=Shinjuku+Gyoen", img: "https://images.unsplash.com/photo-1586791965591-62d4e6669f3d?auto=format&fit=crop&w=600&q=80" },
                { time: "16:30", title: "æ€å‡ºæ©«ä¸", type: "æ™¯é»", note: "é«”é©—æ˜­å’Œæ‡·èˆŠçª„å··ã€‚", link: "https://www.google.com/maps/search/?api=1&query=Omoide+Yokocho", img: "https://images.unsplash.com/photo-1589451814294-26d36298ed22?auto=format&fit=crop&w=600&q=80" },
                { time: "17:30", title: "Alpen Tokyo", type: "è³¼ç‰©", note: "Snow Peak å°ˆå€ï¼Œæˆ¶å¤–ç”¨å“å¤©å ‚ã€‚", link: "https://www.google.com/maps/search/?api=1&query=Alpen+Tokyo", img: "https://images.unsplash.com/photo-1533240332313-0db49b459ad6?auto=format&fit=crop&w=600&q=80" },
                { time: "19:00", title: "æ±äº¬éƒ½å»³å¤œæ™¯", type: "æ™¯é»", note: "å…è²»ä¸Š 45 æ¨“ä¿¯ç°æ±äº¬ã€‚", link: "https://www.google.com/maps/search/?api=1&query=Tokyo+Metropolitan+Government+Building", img: "https://images.unsplash.com/photo-1513407030348-c983a97b98d8?auto=format&fit=crop&w=600&q=80" }
            ],
            "D5 2026-02-07(å…­)": [
                { time: "10:30", title: "æ±äº¬éµå¡”", type: "æ™¯é»", note: "èŠå…¬åœ’æ‹ç…§ç¶“å…¸ä½ã€‚", link: "https://www.google.com/maps/search/?api=1&query=Tokyo+Tower", img: "https://images.unsplash.com/photo-1536098561742-ca998e48cbcc?auto=format&fit=crop&w=600&q=80" },
                { time: "12:30", title: "ç‚¸ç‰›æ’ Motomura", type: "é¤é£²", note: "å£æ„Ÿè»Ÿå«©ï¼Œé€šå¸¸éœ€æ’éšŠã€‚", link: "", img: "https://images.unsplash.com/photo-1551622699-317415170d1e?auto=format&fit=crop&w=600&q=80" },
                { time: "14:00", title: "åœ‹ç«‹æ–°ç¾è¡“é¤¨", type: "æ™¯é»", note: "æ³¢æµªå½¢ç»ç’ƒå¸·å¹•ï¼Œå¤§å»³å…‰å½±ç¾ã€‚", link: "https://www.google.com/maps/search/?api=1&query=The+National+Art+Center+Tokyo", img: "https://images.unsplash.com/photo-1506059612708-99d6c258160e?auto=format&fit=crop&w=600&q=80" },
                { time: "15:30", title: "è¡¨åƒé“ä¹‹ä¸˜", type: "è³¼ç‰©", note: "æ™‚å°šå¤§é“ï¼Œå®‰è—¤å¿ é›„å»ºç¯‰ã€‚", link: "https://www.google.com/maps/search/?api=1&query=Omotesando+Hills", img: "https://images.unsplash.com/photo-1573215984620-e2659e5a1b3a?auto=format&fit=crop&w=600&q=80" },
                { time: "17:30", title: "æ¾€è°· Sky", type: "æ™¯é»", note: "ä¿¯ç°æ±äº¬å…¨æ™¯ (éœ€é ç´„)ã€‚", link: "https://www.google.com/maps/search/?api=1&query=Shibuya+Sky", img: "https://images.unsplash.com/photo-1621849400072-f554417f7051?auto=format&fit=crop&w=600&q=80" },
                { time: "19:00", title: "æ¾€è°·äº¤å‰é»", type: "æ™¯é»", note: "ä¸–ç•Œæœ€ç¹å¿™è·¯å£ã€‚", link: "https://www.google.com/maps/search/?api=1&query=Shibuya+Crossing", img: "https://images.unsplash.com/photo-1542931287-023b922fa89b?auto=format&fit=crop&w=600&q=80" },
                { time: "21:30", title: "æ± å°»å¤§æ©‹ä½å®¿", type: "ä½å®¿", note: "ç›®é»‘å€æ…¢æ´»ç”Ÿæ´»æ„Ÿã€‚", link: "https://www.google.com/maps/search/?api=1&query=Ikejiri-Ohashi", img: "https://images.unsplash.com/photo-1493976040374-85c8e12f0c0e?auto=format&fit=crop&w=600&q=80" }
            ],
            "D6 2026-02-08(æ—¥)": [
                { time: "07:30", title: "å‰å¾€æˆç”°æ©Ÿå ´ T1", type: "äº¤é€š", note: "æ­ä¹˜ NEX æˆ– Skylinerã€‚", link: "", img: "https://images.unsplash.com/photo-1542640244-7e67286feb8f?auto=format&fit=crop&w=600&q=80" },
                { time: "09:15", title: "æŠµé”æ©Ÿå ´å ±åˆ°", type: "äº¤é€š", note: "MM623ã€‚æœ€å¾Œæ¡è²·ä¼´æ‰‹ç¦®ã€‚", link: "", img: "https://images.unsplash.com/photo-1522204523234-8729aa6e3d5f?auto=format&fit=crop&w=600&q=80" },
                { time: "14:30", title: "æŠµé”æ¡ƒåœ’ T1", type: "äº¤é€š", note: "å¹³å®‰å›å®¶ã€‚", link: "", img: "https://images.unsplash.com/photo-1506748686214-e9df14d4d9d0?auto=format&fit=crop&w=600&q=80" }
            ]
        };

        const foodDB = [
            { name: "FamiChiki ç‚¸é›", jp: "ãƒ•ã‚¡ãƒŸãƒã‚­", price: "Â¥240", shop: "FamilyMart", img: "https://images.unsplash.com/photo-1626082927389-6cd097cdc6ec?auto=format&fit=crop&w=600&q=80" },
            { name: "ç‚¸é›å› (è¾£å‘³/èµ·å¸)", jp: "ã‹ã‚‰ã‚ã’ã‚¯ãƒ³", price: "Â¥258", shop: "Lawson", img: "https://images.unsplash.com/photo-1569058242253-92a9c755a0ec?auto=format&fit=crop&w=600&q=80" },
            { name: "é—œæ±ç…®", jp: "ãŠã§ã‚“", price: "Â¥120", shop: "7-11", img: "https://images.unsplash.com/photo-1534422298391-e4f8c172dddb?auto=format&fit=crop&w=600&q=80" },
            { name: "éº»ç³¬å£æ„Ÿç”Ÿä¹³æ²", jp: "ã‚‚ã¡é£Ÿæ„Ÿãƒ­ãƒ¼ãƒ«", price: "Â¥397", shop: "Lawson", img: "https://images.unsplash.com/photo-1563729784474-d77dbb933a9e?auto=format&fit=crop&w=600&q=80" },
            { name: "æ¿ƒåšè›‹é»ƒé†¬æ³¡èŠ™", jp: "ã‚«ã‚¹ã‚¿ãƒ¼ãƒ‰", price: "Â¥150", shop: "7-11", img: "https://images.unsplash.com/photo-1598268121084-c8c7c9e0a0a1?auto=format&fit=crop&w=600&q=80" }
        ];

        // --- ç¨‹å¼é‚è¼¯å€ ---

        let currentDate = "2026-02-03";
        const dates = Object.keys(itineraryDB);

        // åˆå§‹åŒ–
        window.onload = function() {
            renderDateNav();
            renderItinerary(currentDate);
            renderWeather(currentDate);
            renderFood();
            loadExpenses();
        };

        // æ¸²æŸ“æ—¥æœŸå°èˆª (æ›´æ–°ç‚º D1... æ ¼å¼)
        function renderDateNav() {
            const container = document.getElementById('dateNav');
            dates.forEach((date, index) => {
                const dayStr = date.split(' ')[1].substring(5); // å–å‡º 02-03(äºŒ)
                const dLabel = `D${index + 1}`; // D1, D2...
                
                const el = document.createElement('div');
                el.className = `date-chip ${date.startsWith(currentDate) ? 'active' : ''}`;
                el.innerHTML = `<strong>${dLabel}</strong><span>${dayStr}</span>`;
                el.onclick = () => selectDate(date);
                container.appendChild(el);
            });
        }

        // é¸æ“‡æ—¥æœŸ
        function selectDate(dateKey) {
            currentDate = dateKey.split(' ')[1].substring(0,10); 
            
            // æ›´æ–° UI Highlight
            document.querySelectorAll('.date-chip').forEach(el => {
                el.classList.remove('active');
                if(dateKey.includes(el.querySelector('span').innerText.substring(0,2))) el.classList.add('active'); // ç°¡å–®æ¯”å°
                // æ›´ç²¾æº–çš„æ¯”å°
                const chipDay = el.querySelector('span').innerText.split('(')[0];
                if(dateKey.includes(chipDay)) el.classList.add('active');
            });

            renderItinerary(dateKey);
            const weatherDate = dateKey.match(/\d{4}-\d{2}-\d{2}/)[0];
            renderWeather(weatherDate);
        }

        // æ¸²æŸ“è¡Œç¨‹ (åŠ å…¥åœ–ç‰‡èˆ‡æ³¡æ³¡)
        function renderItinerary(key) {
            const list = document.getElementById('itineraryList');
            const items = itineraryDB[key] || [];
            list.innerHTML = "";
            
            items.forEach(item => {
                const navBtn = item.link ? `<a href="${item.link}" target="_blank" class="nav-btn-corner"><i class="fas fa-location-arrow"></i> å°èˆª</a>` : '';
                const imgHtml = item.img ? `<img src="${item.img}" class="card-img" alt="${item.title}">` : '';
                
                const html = `
                <div class="timeline-item">
                    <div class="time-col">${item.time}</div>
                    <div class="content-col">
                        ${navBtn}
                        ${imgHtml}
                        <div class="card-body">
                            <span class="tag ${item.type}">${item.type}</span>
                            <h3>${item.title}</h3>
                            <div class="note">${item.note}</div>
                        </div>
                    </div>
                </div>`;
                list.innerHTML += html;
            });
        }

        // æ¸²æŸ“æ°£è±¡
        function renderWeather(dateStr) {
            const data = weatherDB[dateStr] || { temp: "--", tip: "ç¥æ‚¨æ—…é€”æ„‰å¿«" };
            document.getElementById('currentDateDisplay').innerText = dateStr;
            document.getElementById('weatherTemp').innerText = data.temp;
            document.getElementById('weatherTip').innerHTML = `<i class="fas fa-tshirt"></i> <span>${data.tip}</span>`;
        }

        // æ¸²æŸ“ç¾é£Ÿ (åŠ å…¥åœ–ç‰‡)
        function renderFood() {
            const list = document.getElementById('foodList');
            foodDB.forEach(item => {
                const imgHtml = item.img ? `<img src="${item.img}" class="real-food-img">` : `<div class="food-img-placeholder"><i class="fas fa-utensils"></i></div>`;
                
                list.innerHTML += `
                <div class="food-card">
                    ${imgHtml}
                    <div class="food-info">
                        <div class="food-name">${item.name}</div>
                        <div class="food-jp">${item.jp}</div>
                        <div class="food-price">${item.price} (${item.shop})</div>
                    </div>
                </div>`;
            });
        }

        // èªéŸ³åŠŸèƒ½
        function speak(text, alertText) {
            if ('speechSynthesis' in window) {
                const utterance = new SpeechSynthesisUtterance(text);
                utterance.lang = 'ja-JP'; // è¨­å®šç‚ºæ—¥æ–‡
                window.speechSynthesis.speak(utterance);
            } else {
                alert("æ‚¨çš„ç€è¦½å™¨ä¸æ”¯æ´ç™¼éŸ³åŠŸèƒ½ï¼Œè«‹çœ‹æ–‡å­—ï¼š" + (alertText || text));
            }
        }

        // é é¢åˆ‡æ›
        function switchPage(pageId, navEl) {
            document.querySelectorAll('.page').forEach(p => p.classList.remove('active'));
            document.getElementById(`page-${pageId}`).classList.add('active');
            
            document.querySelectorAll('.nav-item').forEach(n => n.classList.remove('active'));
            navEl.classList.add('active');
        }

        // ç°¡å–®è¨˜å¸³
        function addExpense() {
            const name = document.getElementById('expenseName').value;
            const amount = parseInt(document.getElementById('expenseAmount').value);
            if(!name || !amount) return;

            const list = document.getElementById('expenseList');
            const li = document.createElement('li');
            li.innerText = `${name}: Â¥${amount}`;
            list.appendChild(li);

            updateTotal(amount);

            document.getElementById('expenseName').value = '';
            document.getElementById('expenseAmount').value = '';
            saveData(name, amount);
        }

        let total = 0;
        function updateTotal(amount) {
            total += amount;
            document.getElementById('totalExpense').innerText = `Â¥${total}`;
        }
        
        function saveData(name, amount) {
            let expenses = JSON.parse(localStorage.getItem('tokyo_expenses')) || [];
            expenses.push({ name, amount });
            localStorage.setItem('tokyo_expenses', JSON.stringify(expenses));
        }

        function loadExpenses() {
            let expenses = JSON.parse(localStorage.getItem('tokyo_expenses')) || [];
            const list = document.getElementById('expenseList');
            expenses.forEach(ex => {
                const li = document.createElement('li');
                li.innerText = `${ex.name}: Â¥${ex.amount}`;
                list.appendChild(li);
                updateTotal(ex.amount);
            });
        }
    </script>
</body>
</html>
