<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>華的東京獨旅 2026</title>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@400;500;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            /* --- 溫暖知性色系 (Tokyo Elegance Palette) --- */
            --primary: #6B8E9B; /* 莫蘭迪湖水綠 (主色) */
            --primary-dark: #557582; /* 深湖水綠 */
            --bg: #F9F7F5; /* 溫暖米白底色 */
            --text: #5A5A5A; /* 暖深灰 */
            --text-light: #949494; /* 淺灰 */
            --card-bg: #FFFFFF;
            --accent: #C5A087; /* 奶茶暖棕 (強調色) */
            --line: #E0E0E0; /* 時間軸線條色 (更淡) */
            --bubble-border: #BCCCD1; /* 時間泡泡邊框 (淡化版) */
            
            /* 標籤配色 */
            --tag-transport: #DDE5E8;
            --tag-spot: #EAE4DC;      
            --tag-food: #EFEBE5;      
        }

        * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; }
        body {
            font-family: 'Noto Sans TC', sans-serif;
            background-color: var(--bg);
            color: var(--text);
            margin: 0;
            padding: 0;
            padding-bottom: 90px;
        }

        /* --- Header: 標題與版面優化 --- */
        .header {
            background: linear-gradient(135deg, var(--primary), var(--primary-dark));
            color: white;
            padding: 20px 20px 25px 20px;
            border-radius: 0 0 30px 30px;
            box-shadow: 0 10px 20px rgba(107, 142, 155, 0.25);
            position: sticky;
            top: 0;
            z-index: 100;
            min-height: 140px;
            display: flex;
            flex-direction: column;
            justify-content: space-between;
        }
        
        .title-area {
            display: flex;
            align-items: center; 
            justify-content: flex-start;
            flex-wrap: wrap;
            gap: 8px;
            margin-bottom: 10px;
        }
        
        #mainTitle {
            margin: 0;
            font-size: 1.25rem;
            font-weight: 700;
            letter-spacing: 1.5px;
            text-shadow: 0 2px 4px rgba(0,0,0,0.1);
            line-height: 1.4;
            white-space: nowrap;
        }
        
        /* 日系手繪風插圖 - 優化為知性女性風格 */
        .walking-icon-img {
            width: 48px;
            height: 48px;
            border-radius: 50%;
            border: 2px solid rgba(255,255,255,0.8);
            object-fit: cover;
            animation: soft-float 4s infinite ease-in-out;
            margin-left: 5px;
            box-shadow: 0 4px 8px rgba(0,0,0,0.2);
            background: white; 
        }

        @keyframes soft-float {
            0% { transform: translateY(0) rotate(0deg); }
            50% { transform: translateY(-3px) rotate(3deg); }
            100% { transform: translateY(0) rotate(0deg); }
        }

        /* 氣象區塊 */
        .weather-widget {
            display: flex;
            justify-content: space-between;
            align-items: flex-end;
            position: relative;
            height: 50px;
        }
        
        .temp-box {
            position: absolute;
            left: 0;
            bottom: 0;
        }
        .temp-box p { margin: 0; font-size: 0.75rem; opacity: 0.9; font-weight: 400; margin-bottom: 2px;}
        .temp-box h1 { margin: 0; font-size: 1.3rem; font-weight: 500; letter-spacing: 1px; line-height: 1; }
        .temp-box i { font-size: 1.1rem; margin-right: 5px; vertical-align: middle; }
        
        /* 穿搭建議 */
        .outfit-tip {
            background: rgba(255,255,255,0.2);
            padding: 8px 12px;
            border-radius: 12px;
            font-size: 0.75rem;
            display: flex;
            align-items: center;
            gap: 6px;
            backdrop-filter: blur(5px);
            line-height: 1.3;
            border: 1px solid rgba(255,255,255,0.3);
            position: absolute;
            right: 0;
            bottom: 0;
            max-width: 65%;
            height: 42px;
            overflow: hidden;
        }
        .outfit-tip i { font-size: 0.9rem; flex-shrink: 0; }

        /* --- 日期選擇器 --- */
        .date-scroller {
            display: flex;
            overflow-x: auto;
            padding: 15px 15px;
            gap: 10px;
            scrollbar-width: none;
            background: var(--bg);
        }
        .date-scroller::-webkit-scrollbar { display: none; }
        
        .date-chip {
            background: white;
            min-width: 65px;
            height: 65px;
            padding: 8px;
            border-radius: 16px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            color: var(--text-light);
            border: 1px solid transparent;
            transition: all 0.2s ease;
            cursor: pointer;
            box-shadow: 0 2px 8px rgba(0,0,0,0.03);
            flex-shrink: 0;
        }
        .date-chip strong {
            font-size: 1.1rem;
            font-weight: 700;
            margin-bottom: 2px;
            color: #C0C0C0;
        }
        .date-chip span { font-size: 0.7rem; }
        
        .date-chip.active {
            background: white;
            border: 2px solid var(--primary);
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(107, 142, 155, 0.3);
        }
        .date-chip.active strong { color: var(--primary) !important; }
        .date-chip.active span { color: var(--primary) !important; font-weight: bold; }

        /* --- 行程時間軸 --- */
        .timeline-container { padding: 10px 20px; }
        
        .timeline-item {
            display: flex;
            margin-bottom: 25px;
            position: relative;
        }

        .timeline-item::before {
            content: '';
            position: absolute;
            left: 28px;
            top: 0;
            bottom: -25px;
            width: 2px;
            background: var(--line);
            z-index: 0;
        }
        .timeline-item:last-child::before { display: none; }

        .time-wrapper {
            width: 65px;
            flex-shrink: 0;
            display: flex;
            flex-direction: column;
            align-items: center;
            padding-top: 10px;
            z-index: 1;
            margin-right: 10px;
        }

        .time-bubble {
            background: white;
            color: var(--primary);
            border: 2px solid var(--bubble-border);
            border-radius: 20px;
            padding: 4px 8px;
            font-size: 0.75rem;
            font-weight: 700;
            box-shadow: 0 2px 5px rgba(0,0,0,0.05);
            z-index: 2;
            text-align: center;
            min-width: 50px;
        }

        .content-col {
            flex: 1;
            background: var(--card-bg);
            border-radius: 16px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.03);
            position: relative;
            z-index: 1;
            overflow: hidden;
            border: 1px solid rgba(0,0,0,0.01);
            display: flex; 
            flex-direction: row;
            min-height: 110px;
        }

        .card-img-col {
            width: 33%;
            min-width: 100px;
            position: relative;
            overflow: hidden;
            background-color: #eee;
        }
        .card-img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            position: absolute;
            top: 0;
            left: 0;
            transition: transform 0.5s ease;
        }

        .card-body { 
            flex: 1;
            padding: 12px 15px; 
            display: flex;
            flex-direction: column;
            justify-content: center;
        }

        .content-col h3 { margin: 0 0 5px 0; font-size: 1.05rem; color: #4F5D64; font-weight: 700; line-height: 1.3; }
        
        .tag {
            display: inline-block;
            font-size: 0.65rem;
            padding: 2px 6px;
            border-radius: 4px;
            color: #666;
            margin-bottom: 6px;
            font-weight: 500;
            width: fit-content;
        }
        .tag.交通 { background: var(--tag-transport); color: #546E7A; }
        .tag.景點, .tag.觀光 { background: var(--tag-spot); color: #8D7663; }
        .tag.餐飲, .tag.購物 { background: var(--tag-food); color: #8A7E72; }
        .tag.住宿 { background: var(--tag-transport); color: #607D8B; }

        .note {
            font-size: 0.8rem;
            color: #888;
            margin-top: 5px;
            line-height: 1.4;
            display: -webkit-box;
            -webkit-line-clamp: 3;
            -webkit-box-orient: vertical;
            overflow: hidden;
        }

        .nav-btn-corner {
            position: absolute;
            top: 10px;
            right: 10px;
            color: var(--primary);
            background: rgba(255,255,255,0.8);
            width: 28px;
            height: 28px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.9rem;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
            z-index: 5;
            text-decoration: none;
        }

        /* --- 底部導航 --- */
        .bottom-nav {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            background: white;
            display: flex;
            justify-content: space-around;
            padding: 10px 0;
            box-shadow: 0 -4px 20px rgba(0,0,0,0.05);
            z-index: 200;
            border-top-left-radius: 20px;
            border-top-right-radius: 20px;
        }
        .nav-item {
            text-align: center;
            color: #C0C0C0;
            font-size: 0.75rem;
            cursor: pointer;
            transition: color 0.3s;
        }
        .nav-item.active { color: var(--primary); }
        .nav-item i { font-size: 1.2rem; display: block; margin-bottom: 4px; }

        /* --- 其他頁面 --- */
        .page { display: none; padding-bottom: 20px; animation: fadeIn 0.3s ease; }
        .page.active { display: block; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }

        .food-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 15px; padding: 15px; }
        .food-card { background: white; border-radius: 15px; overflow: hidden; box-shadow: 0 4px 10px rgba(0,0,0,0.03); }
        .real-food-img { width: 100%; height: 120px; object-fit: cover; }
        .food-info { padding: 12px; }
        .food-name { font-weight: bold; font-size: 0.9rem; margin-bottom: 3px; color: #555; }
        .food-jp { color: #999; font-size: 0.75rem; margin-bottom: 5px; }
        .food-price { color: var(--accent); font-weight: bold; font-size: 0.9rem; }

        .tools-container { padding: 20px; }
        .tool-card { background: white; padding: 20px; border-radius: 16px; margin-bottom: 20px; box-shadow: 0 4px 10px rgba(0,0,0,0.03); }
        .tool-card h3 { color: var(--primary); margin-top: 0; font-size: 1.1rem; }
        
        .input-group { display: flex; flex-direction: column; gap: 10px; margin-bottom: 10px; }
        .input-group input { width: 100%; padding: 12px; border: 1px solid #eee; border-radius: 8px; font-size: 1rem; background: #FAFAFA; }

        .tool-btn { background: var(--accent); color: white; border: none; padding: 12px; width: 100%; border-radius: 10px; font-size: 1rem; margin-top: 10px; cursor: pointer; }
        .translate-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; }
        .phrase-btn { background: white; border: 1px solid var(--accent); color: var(--accent); padding: 15px 10px; border-radius: 12px; text-align: center; font-size: 0.9rem; cursor: pointer; }
        .phrase-btn i { display: block; margin-bottom: 5px; opacity: 0.5; }

    </style>
</head>
<body>

    <div class="header" id="headerWidget">
        <div class="title-area">
            <h2 id="mainTitle">◈ 東京慢旅．只屬於我的日常 ◈</h2>
            <img src="https://images.unsplash.com/photo-1543132220-4bf3de6e10ae?auto=format&fit=crop&w=200&q=80" class="walking-icon-img" alt="Traveler">
        </div>
        <div class="weather-widget">
            <div class="temp-box">
                <p id="currentDateDisplay">2月3日 (二)</p>
                <h1 id="weatherTemp">6°C</h1>
            </div>
            <div class="outfit-tip" id="weatherTip">
                <i class="fas fa-tshirt"></i> <span>寒冷，請穿著羽絨衣並攜帶圍巾</span>
            </div>
        </div>
    </div>

    <div class="date-scroller" id="dateNav"></div>

    <div id="page-itinerary" class="page active">
        <div class="timeline-container" id="itineraryList"></div>
    </div>

    <div id="page-food" class="page">
        <div style="padding: 20px;">
            <h2 style="color:var(--text); font-weight:500; font-size: 1.3rem;"><i class="fas fa-utensils" style="color:var(--primary)"></i> 超商必吃</h2>
            <p style="color:#888; font-size:0.85rem;">已為您整理好清單，結帳時可直接出示圖片給店員看。</p>
        </div>
        <div class="food-grid" id="foodList"></div>
    </div>

    <div id="page-tools" class="page">
        <div class="tools-container">
            <div class="tool-card">
                <h3><i class="fas fa-volume-up"></i> 點擊說日文</h3>
                <div class="translate-grid">
                    <div class="phrase-btn" onclick="speak('すみません、トイレはどこですか？')"><i class="fas fa-restroom"></i> 廁所在哪裡</div>
                    <div class="phrase-btn" onclick="speak('これをください。')"><i class="fas fa-hand-pointer"></i> 請給我這個</div>
                    <div class="phrase-btn" onclick="speak('お会計をお願いします。')"><i class="fas fa-wallet"></i> 麻煩結帳</div>
                    <div class="phrase-btn" onclick="speak('袋はいりません。')"><i class="fas fa-shopping-bag"></i> 不用袋子</div>
                </div>
                <button class="tool-btn" style="background:var(--primary); margin-top:15px;" onclick="window.open('https://translate.google.com/')">開啟 Google 翻譯</button>
            </div>

            <div class="tool-card">
                <h3><i class="fas fa-calculator"></i> 快速記帳</h3>
                <div class="input-group">
                    <input type="text" id="expenseName" placeholder="項目 (如: 拉麵)">
                    <input type="number" id="expenseAmount" placeholder="日幣金額">
                </div>
                <button class="tool-btn" onclick="addExpense()">加入記帳</button>
                <div style="margin-top: 20px; border-top: 1px solid #eee; padding-top:10px;">
                    <h4>今日總計: <span id="totalExpense" style="color:var(--accent)">¥0</span></h4>
                    <ul id="expenseList" style="padding-left: 20px; color:#666; font-size:0.9rem;"></ul>
                </div>
            </div>
        </div>
    </div>

    <div class="bottom-nav">
        <div class="nav-item active" onclick="switchPage('itinerary', this)"><i class="fas fa-route"></i> 行程</div>
        <div class="nav-item" onclick="switchPage('food', this)"><i class="fas fa-cookie-bite"></i> 美食</div>
        <div class="nav-item" onclick="switchPage('tools', this)"><i class="fas fa-tools"></i> 工具</div>
    </div>

    <script>
        const pageTitles = ["◈ 東京慢旅．只屬於我的日常 ◈", "一個人的節奏，最剛好的東京", "與城市輕聲說話的日子", "在街角光影中．飛翔", "一杯咖啡，一條街，剛剛好的自在", "把日子走成風景．輕揚"];

        // 更新天氣資料庫：加入圖示
        const weatherDB = {
            "2026-02-03": { temp: "5-11°", icon: "fa-cloud-sun", tip: "搭機日，建議洋蔥式穿搭。" },
            "2026-02-04": { temp: "3-9°", icon: "fa-sun", tip: "戶外多，穿羽絨衣與好走的鞋。" },
            "2026-02-05": { temp: "2-8°", icon: "fa-snowflake", tip: "氣溫轉冷，建議戴毛帽保暖。" },
            "2026-02-06": { temp: "4-10°", icon: "fa-cloud", tip: "市區逛街，穿著舒適保暖即可。" },
            "2026-02-07": { temp: "5-12°", icon: "fa-sun", tip: "天氣回暖，適合拍照。" },
            "2026-02-08": { temp: "6-13°", icon: "fa-plane", tip: "返程日，行李保持輕便。" }
        };

        // 修復所有行程圖片
        const itineraryDB = {
            "D1 2026-02-03(二)": [
                { time: "15:35", title: "桃園 T1 起飛 (IT202)", type: "交通", note: "機場先吃午餐。13:30 報到。", link: "geo:25.0797,121.2342", img: "https://images.unsplash.com/photo-1436491865332-7a61a10e26d3?auto=format&fit=crop&w=600&q=80" },
                { time: "19:35", title: "抵達成田 T2", type: "交通", note: "購買/儲值西瓜卡 (Suica)。", link: "geo:35.7719,140.3929", img: "https://images.unsplash.com/photo-1542640244-7e67286feb8f?auto=format&fit=crop&w=600&q=80" },
                { time: "20:30", title: "Skyliner 往市區", type: "交通", note: "車上吃點輕食。車程45分。", link: "", img: "https://images.unsplash.com/photo-1503899036084-c55cdd92da26?auto=format&fit=crop&w=600&q=80" },
                { time: "21:45", title: "入住：四谷京阪飯店", type: "住宿", note: "四谷站步行3分。樓下有超市。", link: "http://google.com/maps?q=Hotel+Keihan+Yotsuya", img: "https://images.unsplash.com/photo-1566073771259-6a8506099945?auto=format&fit=crop&w=600&q=80" }
            ],
            "D2 2026-02-04(三)": [
                { time: "09:30", title: "上野東照宮", type: "景點", note: "金碧輝煌江戶建築與牡丹花園。", link: "http://google.com/maps?q=Ueno+Toshogu", img: "https://images.unsplash.com/photo-1624253321171-1be53e12f5f4?auto=format&fit=crop&w=600&q=80" },
                { time: "10:30", title: "上野恩賜公園", type: "景點", note: "不忍池觀鳥、辯天堂散步。", link: "http://google.com/maps?q=Ueno+Park", img: "https://images.unsplash.com/photo-1578469550956-0e16b69c6a3d?auto=format&fit=crop&w=600&q=80" },
                { time: "11:30", title: "阿美橫丁", type: "購物", note: "熱鬧市集，買藥妝、水果。", link: "http://google.com/maps?q=Ameyoko", img: "https://images.unsplash.com/photo-1621501659345-d86b974df724?auto=format&fit=crop&w=600&q=80" },
                { time: "13:00", title: "淺草寺 & 雷門", type: "景點", note: "人多小心。仲見世通吃人形燒。", link: "http://google.com/maps?q=Sensoji", img: "https://images.unsplash.com/photo-1493976040374-85c8e12f0c0e?auto=format&fit=crop&w=600&q=80" },
                { time: "14:00", title: "龜十銅鑼燒", type: "餐飲", note: "雷門對面，排隊伴手禮。", link: "http://google.com/maps?q=Kamejuu", img: "https://images.unsplash.com/photo-1582722872445-44ad5f73a77d?auto=format&fit=crop&w=600&q=80" }
            ],
            "D3 2026-02-05(四)": [
                { time: "09:00", title: "皇居 (二重橋)", type: "景點", note: "必帶護照。欣賞護城河、石垣。", link: "http://google.com/maps?q=Imperial+Palace", img: "https://images.unsplash.com/photo-1540959733332-eab4deabeeaf?auto=format&fit=crop&w=600&q=80" },
                { time: "15:00", title: "秋葉原尋寶", type: "購物", note: "無線電會館，找志摩凜公仔。", link: "http://google.com/maps?q=Akihabara", img: "https://images.unsplash.com/photo-1566131444301-8645ac064414?auto=format&fit=crop&w=600&q=80" }
            ],
            "D4 2026-02-06(五)": [
                { time: "13:30", title: "新宿御苑", type: "景點", note: "《言葉之庭》取景，庭園極美。", link: "http://google.com/maps?q=Shinjuku+Gyoen", img: "https://images.unsplash.com/photo-1583307130403-129613636531?auto=format&fit=crop&w=600&q=80" },
                { time: "16:30", title: "思出橫丁", type: "景點", note: "體驗昭和懷舊窄巷。", link: "http://google.com/maps?q=Omoide+Yokocho", img: "https://images.unsplash.com/photo-1589451814294-26d36298ed22?auto=format&fit=crop&w=600&q=80" }
            ],
            "D5 2026-02-07(六)": [
                { time: "12:30", title: "炸牛排 Motomura", type: "餐飲", note: "口感軟嫩，通常需排隊。", link: "http://google.com/maps?q=Gyukatsu+Motomura", img: "https://images.unsplash.com/photo-1594179047519-f347310d3322?auto=format&fit=crop&w=600&q=80" },
                { time: "15:30", title: "表參道之丘", type: "購物", note: "時尚大道，安藤忠雄建築。", link: "http://google.com/maps?q=Omotesando+Hills", img: "https://images.unsplash.com/photo-1627914723086-5381a17531c3?auto=format&fit=crop&w=600&q=80" }
            ],
            "D6 2026-02-08(日)": [
                { time: "07:30", title: "前往成田機場", type: "交通", note: "搭乘 NEX 或 Skyliner。", link: "", img: "https://images.unsplash.com/photo-1579532537598-459ecdaf39cc?auto=format&fit=crop&w=600&q=80" },
                { time: "14:30", title: "抵達桃園 T1", type: "交通", note: "平安回家。", link: "", img: "https://images.unsplash.com/photo-1476820865390-c59aeeb9e194?auto=format&fit=crop&w=600&q=80" }
            ]
        };

        // 修復美食圖片
        const foodDB = [
            { name: "FamiChiki 炸雞", jp: "ファミチキ", price: "¥240", shop: "FamilyMart", img: "https://images.unsplash.com/photo-1626082927389-6cd097cdc6ec?auto=format&fit=crop&w=600&q=80" },
            { name: "濃厚蛋黃醬泡芙", jp: "カスタード", price: "¥150", shop: "7-11", img: "https://images.unsplash.com/photo-1563729784474-d77dbb933a9e?auto=format&fit=crop&w=600&q=80" }
        ];

        let currentDate = "2026-02-03";
        const dates = Object.keys(itineraryDB);

        window.onload = function() {
            renderDateNav();
            renderItinerary("D1 2026-02-03(二)");
            renderWeather(currentDate);
            renderFood();
        };

        function renderDateNav() {
            const container = document.getElementById('dateNav');
            container.innerHTML = "";
            dates.forEach((date, index) => {
                const dayStr = date.split(' ')[1].substring(5);
                const dLabel = `D${index + 1}`;
                const dateKey = date.split(' ')[1].substring(0,10);
                const el = document.createElement('div');
                el.className = 'date-chip' + (currentDate === dateKey ? ' active' : '');
                el.innerHTML = `<strong>${dLabel}</strong><span>${dayStr}</span>`;
                el.onclick = () => {
                    currentDate = dateKey;
                    document.getElementById('mainTitle').innerText = pageTitles[index];
                    renderDateNav();
                    renderItinerary(date);
                    renderWeather(dateKey);
                };
                container.appendChild(el);
            });
        }

        function renderItinerary(key) {
            const list = document.getElementById('itineraryList');
            const items = itineraryDB[key] || [];
            list.innerHTML = "";
            items.forEach(item => {
                const navBtn = item.link ? `<a href="${item.link}" target="_blank" class="nav-btn-corner"><i class="fas fa-location-arrow"></i></a>` : '';
                list.innerHTML += `
                <div class="timeline-item">
                    <div class="time-wrapper"><div class="time-bubble">${item.time}</div></div>
                    <div class="content-col">
                        ${navBtn}
                        <div class="card-img-col"><img src="${item.img}" class="card-img"></div>
                        <div class="card-body">
                            <span class="tag ${item.type}">${item.type}</span>
                            <h3>${item.title}</h3>
                            <div class="note">${item.note}</div>
                        </div>
                    </div>
                </div>`;
            });
        }

        function renderWeather(dateStr) {
            const data = weatherDB[dateStr] || { temp: "--", tip: "祝您旅途愉快", icon: "fa-sun" };
            document.getElementById('currentDateDisplay').innerText = dateStr;
            document.getElementById('weatherTemp').innerHTML = `<i class="fas ${data.icon}"></i>${data.temp}`;
            document.getElementById('weatherTip').innerHTML = `<i class="fas fa-tshirt"></i> <span>${data.tip}</span>`;
        }

        function renderFood() {
            const list = document.getElementById('foodList');
            foodDB.forEach(item => {
                list.innerHTML += `
                <div class="food-card">
                    <img src="${item.img}" class="real-food-img">
                    <div class="food-info">
                        <div class="food-name">${item.name}</div>
                        <div class="food-jp">${item.jp}</div>
                        <div class="food-price">${item.price} (${item.shop})</div>
                    </div>
                </div>`;
            });
        }

        function speak(text) {
            if ('speechSynthesis' in window) {
                const utterance = new SpeechSynthesisUtterance(text);
                utterance.lang = 'ja-JP';
                window.speechSynthesis.speak(utterance);
            }
        }

        function switchPage(pageId, navEl) {
            document.querySelectorAll('.page').forEach(p => p.classList.remove('active'));
            document.getElementById(`page-${pageId}`).classList.add('active');
            document.querySelectorAll('.nav-item').forEach(n => n.classList.remove('active'));
            navEl.classList.add('active');
        }

        function addExpense() {
            const name = document.getElementById('expenseName').value;
            const amount = parseInt(document.getElementById('expenseAmount').value);
            if(!name || !amount) return;
            const list = document.getElementById('expenseList');
            const li = document.createElement('li');
            li.innerText = `${name}: ¥${amount}`;
            list.appendChild(li);
            const totalEl = document.getElementById('totalExpense');
            let currentTotal = parseInt(totalEl.innerText.replace('¥', '')) || 0;
            totalEl.innerText = `¥${currentTotal + amount}`;
            document.getElementById('expenseName').value = '';
            document.getElementById('expenseAmount').value = '';
        }
    </script>
</body>
</html>
